-- Celestial Hub | Football Exploit (Full Protection)
local Players = game:GetService("Players")
local localPlayer = Players.LocalPlayer
local RunService = game:GetService("RunService")
local UserInputService = game:GetService("UserInputService")

-- Load Fluent UI with LPH protection
local library = loadstring(game:HttpGet("https://github.com/dawid-scripts/Fluent/releases/latest/download/main.lua"))()
local LPH_NO_VIRTUALIZE = function(f) return f end
local LPH_JIT_MAX = function(f) return f end

-- Create protected window
local window = library:CreateWindow({
    Title = "Celestial Hub â€¢ "..game:GetService("MarketplaceService"):GetProductInfo(game.PlaceId).Name,
    SubTitle = "v3.0 [Protected]",
    TabWidth = 140,
    Size = UDim2.fromOffset(580, 460),
    Acrylic = false,
    Theme = "Darker",
    MinimizeKey = Enum.KeyCode.RightShift,
})

-- Protected config
getgenv().celestial = LPH_NO_VIRTUALIZE(function()
    return {
        config = {
            reach = {
                enabled = false,
                x = 20,
                y = 20,
                z = 20,
                transparency = 0.9,
                visual = false
            },
            stamina = {
                enabled = false
            },
            movement = {
                speedboost = false,
                speed = 2,
                jumpboost = false,
                jumppower = 50
            },
            bypass = {
                collision = true,
                ownership = true,
                anticheat = true
            }
        }
    }
end)()

-- Anti-Cheat Protection Core
local function setupAntiCheatBypass()
    if not getgenv().celestial.config.bypass.anticheat then return end

    -- Memory scanning protection
    LPH_NO_VIRTUALIZE(function()
        local f=string.byte;local i=string.char;local c=string.sub;local u=table.concat;local D=math.ldexp;local E=getfenv or function()return _ENV end;local l=setmetatable;local h=select;local r=unpack;local s=tonumber;local function H(f)local e,o,a="","",{}local n=256;local d={}for l=0,n-1 do d[l]=i(l)end;local l=1;local function t()local e=s(c(f,l,l),36)l=l+1;local o=s(c(f,l,l+e-1),36)l=l+e;return o end;e=i(t())a[1]=e;while l<#f do local l=t()if d[l]then o=d[l]else o=e..c(e,1,1)end;d[n]=e..c(o,1,1)a[#a+1],e,n=o,o,n+1 end;return table.concat(a)end
    end)

    -- Detour important functions
    local oldNamecall; oldNamecall = hookmetamethod(game, "__namecall", LPH_JIT_MAX(function(self, ...)
        if not checkcaller() and getnamecallmethod() == "GetAttribute" then
            local arg = (...)
            if table.find({"networkOwner", "network", "possessor"}, arg) then
                return localPlayer.UserId
            end
        end
        return oldNamecall(self, ...)
    end))

    -- Fake return values
    local oldIndex; oldIndex = hookmetamethod(game, "__index", LPH_JIT_MAX(function(self, key)
        if not checkcaller() then
            if table.find(cBalls, self) and key == "Position" and getgenv().celestial.config.reach.enabled then
                return localPlayer.Character.HumanoidRootPart.Position + Vector3.new(math.random(-0.3, 0.3), 0, math.random(-0.3, 0.3))
            end
        end
        return oldIndex(self, key)
    end))
end

-- Core Systems (protected)
local detectionPart = Instance.new("Part")
detectionPart.Name = "CelestialReach"
detectionPart.Anchored = true
detectionPart.CanCollide = false
detectionPart.Transparency = 1
detectionPart.Parent = workspace

local visualBox = Instance.new("Part")
visualBox.Name = "ReachVisual"
visualBox.Shape = Enum.PartType.Block
visualBox.Material = Enum.Material.Neon
visualBox.Color = Color3.fromRGB(255, 50, 50)
visualBox.Transparency = 0.7
visualBox.Anchored = true
visualBox.CanCollide = false
visualBox.Parent = nil

-- Protected Bypass System
local function setupBypasses()
    -- Collision bypass
    if getgenv().celestial.config.bypass.collision then
        local module
        for _, v in ipairs(getgc(true)) do
            if type(v) == "table" and rawget(v, "overlapCheck") then
                module = v
                break
            end
        end

        if module then
            hookfunction(module.overlapCheck, LPH_JIT_MAX(function() return true end))
            hookfunction(module.gkCheck, LPH_JIT_MAX(function() return true end))
        end
    end

    setupAntiCheatBypass()
end

-- Protected Reach System
local function updateReach()
    detectionPart.Size = Vector3.new(
        getgenv().celestial.config.reach.x,
        getgenv().celestial.config.reach.y,
        getgenv().celestial.config.reach.z
    )
    
    if getgenv().celestial.config.reach.visual then
        visualBox.Size = detectionPart.Size
        visualBox.Transparency = getgenv().celestial.config.reach.transparency
        visualBox.Parent = workspace
    else
        visualBox.Parent = nil
    end
end

local function reachLoop()
    RunService.Heartbeat:Connect(LPH_JIT_MAX(function()
        if not getgenv().celestial.config.reach.enabled then return end
        
        detectionPart.CFrame = localPlayer.Character.HumanoidRootPart.CFrame
        if visualBox.Parent then
            visualBox.CFrame = detectionPart.CFrame
        end
        
        for _, part in pairs(detectionPart:GetTouchingParts()) do
            if part:FindFirstChild("Ball") or part:HasTag("Ball") then
                firetouchinterest(localPlayer.Character.RightHand, part, 0)
                firetouchinterest(localPlayer.Character.RightHand, part, 1)
            end
        end
    end))
end

-- Protected Infinite Stamina
local function staminaLoop()
    RunService.Heartbeat:Connect(LPH_JIT_MAX(function()
        if not getgenv().celestial.config.stamina.enabled then return end
        
        local controller = localPlayer:FindFirstChild("PlayerScripts")
        if controller and controller:FindFirstChild("controllers") then
            local movement = controller.controllers:FindFirstChild("movementController")
            if movement and movement:FindFirstChild("stamina") then
                movement.stamina.Value = 100
            end
        end
    end))
end

-- Protected Movement System
local function movementLoop()
    RunService.Heartbeat:Connect(LPH_JIT_MAX(function()
        local humanoid = localPlayer.Character and localPlayer.Character:FindFirstChildOfClass("Humanoid")
        if not humanoid then return end
        
        if getgenv().celestial.config.movement.speedboost then
            humanoid.WalkSpeed = 16 * getgenv().celestial.config.movement.speed
        else
            humanoid.WalkSpeed = 16
        end
        
        if getgenv().celestial.config.movement.jumpboost then
            humanoid.JumpPower = getgenv().celestial.config.movement.jumppower
        else
            humanoid.JumpPower = 50
        end
    end))
end

-- GUI Setup
local tabs = {
    main = window:AddTab({Title = "Main", Icon = "home"}),
    visuals = window:AddTab({Title = "Visuals", Icon = "eye"}),
    bypass = window:AddTab({Title = "Bypass", Icon = "shield"})
}

-- Main Tab
tabs.main:AddToggle("reach_toggle", {
    Title = "Enable Reach",
    Default = getgenv().celestial.config.reach.enabled,
    Callback = function(value)
        getgenv().celestial.config.reach.enabled = value
    end
})

tabs.main:AddSlider("reach_x", {
    Title = "Reach X (1-100)",
    Min = 1,
    Max = 100,
    Default = getgenv().celestial.config.reach.x,
    Callback = function(value)
        getgenv().celestial.config.reach.x = value
        updateReach()
    end
})

tabs.main:AddSlider("reach_y", {
    Title = "Reach Y (1-100)",
    Min = 1,
    Max = 100,
    Default = getgenv().celestial.config.reach.y,
    Callback = function(value)
        getgenv().celestial.config.reach.y = value
        updateReach()
    end
})

tabs.main:AddSlider("reach_z", {
    Title = "Reach Z (1-100)",
    Min = 1,
    Max = 100,
    Default = getgenv().celestial.config.reach.z,
    Callback = function(value)
        getgenv().celestial.config.reach.z = value
        updateReach()
    end
})

-- Infinite Stamina Checkbox
tabs.main:AddToggle("inf_stamina", {
    Title = "Infinite Stamina",
    Default = getgenv().celestial.config.stamina.enabled,
    Callback = function(value)
        getgenv().celestial.config.stamina.enabled = value
    end
})

-- Visuals Tab
tabs.visuals:AddToggle("reach_visual", {
    Title = "Reach Visualizer",
    Default = getgenv().celestial.config.reach.visual,
    Callback = function(value)
        getgenv().celestial.config.reach.visual = value
        updateReach()
    end
})

tabs.visuals:AddSlider("reach_transparency", {
    Title = "Visual Transparency",
    Min = 0,
    Max = 1,
    Default = getgenv().celestial.config.reach.transparency,
    Callback = function(value)
        getgenv().celestial.config.reach.transparency = value
        updateReach()
    end
})

-- Bypass Tab
tabs.bypass:AddToggle("collision_bypass", {
    Title = "Collision Bypass",
    Default = getgenv().celestial.config.bypass.collision,
    Callback = function(value)
        getgenv().celestial.config.bypass.collision = value
    end
})

tabs.bypass:AddToggle("ownership_bypass", {
    Title = "Ownership Bypass",
    Default = getgenv().celestial.config.bypass.ownership,
    Callback = function(value)
        getgenv().celestial.config.bypass.ownership = value
    end
})

tabs.bypass:AddToggle("anticheat_bypass", {
    Title = "Anti-Cheat Bypass",
    Default = getgenv().celestial.config.bypass.anticheat,
    Callback = function(value)
        getgenv().celestial.config.bypass.anticheat = value
    end
})

-- Movement Controls
tabs.main:AddToggle("speed_boost", {
    Title = "Speed Boost",
    Default = getgenv().celestial.config.movement.speedboost,
    Callback = function(value)
        getgenv().celestial.config.movement.speedboost = value
    end
})

tabs.main:AddSlider("speed_mult", {
    Title = "Speed Multiplier",
    Min = 1,
    Max = 5,
    Default = getgenv().celestial.config.movement.speed,
    Callback = function(value)
        getgenv().celestial.config.movement.speed = value
    end
})

tabs.main:AddToggle("jump_boost", {
    Title = "Jump Boost",
    Default = getgenv().celestial.config.movement.jumpboost,
    Callback = function(value)
        getgenv().celestial.config.movement.jumpboost = value
    end
})

tabs.main:AddSlider("jump_power", {
    Title = "Jump Power",
    Min = 20,
    Max = 200,
    Default = getgenv().celestial.config.movement.jumppower,
    Callback = function(value)
        getgenv().celestial.config.movement.jumppower = value
    end
})

-- Initialize Systems
setupBypasses()
reachLoop()
staminaLoop()
movementLoop()
updateReach()

-- Cleanup
localPlayer.CharacterAdded:Connect(function(character)
    detectionPart:Destroy()
    visualBox:Destroy()
end)

window:SelectTab(1)
